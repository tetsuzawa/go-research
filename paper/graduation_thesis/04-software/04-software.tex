\
\section{ソフトウェアの製作}\label{ux30bdux30d5ux30c8ux30a6ux30a7ux30a2ux306eux88fdux4f5c}}

\
\section{使用するソフトウェア・プログラムについて}\label{ux4f7fux7528ux3059ux308bux30bdux30d5ux30c8ux30a6ux30a7ux30a2ux30d7ux30edux30b0ux30e9ux30e0ux306bux3064ux3044ux3066}}

本研究ではシミュレーションとデータ処理のためにPythonとGo言語を主に使用した。

\
\subsection{Pythonについて}\label{pythonux306bux3064ux3044ux3066}}

Pythonは、汎用のプログラミング言語である。コードがシンプルで扱いやすく設計されており、C言語などに比べて、さまざまなプログラムを分かりやすく、少ないコード行数で書けるといった特徴がある。

標準ライブラリやサードパーティ製のライブラリなど、さまざまな領域に特化した豊富で大規模なツール群が用意され、自らの使用目的に応じて機能を拡張していくことができる。

このような特徴から、様々な試行をしながら行う開発に適している。本研究ではこの特性を活かし、予備実験・データ処理・グラフ作成にPythonを使用している。

\
\subsection{Go言語について}\label{goux8a00ux8a9eux306bux3064ux3044ux3066}}

Googleで開発された、汎用のプログラミング言語である。Goは、静的型付け、C言語の伝統に則ったコンパイル言語、メモリ安全性、ガベージコレクション、並行性などの特徴を持つ。また、軽量スレッディングのための機能、Pythonのような動的型付け言語のようなプログラミングの容易性、などの特徴もある。

また、GoはPythonのようにシンプルな記法をもち、誰が書いても同じコードになりやすく学習しやすいため、研究用途に適した言語である。

\
\subsection{プログラミング言語の使い分けについて}\label{ux30d7ux30edux30b0ux30e9ux30dfux30f3ux30b0ux8a00ux8a9eux306eux4f7fux3044ux5206ux3051ux306bux3064ux3044ux3066}}

Pythonは@で述べた特徴から、様々な試行をしながら行う開発に適している。一方で、速度が遅く、リアルタイム処理には向かない。したがって、本研究ではこの特性を活かし、予備実験・データ処理・グラフ作成にPythonを使用した。

また、Goは言語仕様が現代的で、実行速度が速く、クロスコンパイルが可能といった特徴から、ADFライブラリの作成および実装に使用した。

@TODO

\
\section{Pythonを使用した適応フィルタの予備実験}\label{pythonux3092ux4f7fux7528ux3057ux305fux9069ux5fdcux30d5ux30a3ux30ebux30bfux306eux4e88ux5099ux5b9fux9a13}}

\
\subsection{音声ファイル処理およびグラフ作成プログラムの制作}\label{ux97f3ux58f0ux30d5ux30a1ux30a4ux30ebux51e6ux7406ux304aux3088ux3073ux30b0ux30e9ux30d5ux4f5cux6210ux30d7ux30edux30b0ux30e9ux30e0ux306eux5236ux4f5c}}

本節では後述の実験結果の処理に使用したプログラムの制作について述べる。

音声ファイルの処理には行列演算が必要である。この処理には数値計算を効率的に行うための拡張モジュールであるNumPyを使用した。また、波形のプロットにはNumPyを基盤にしたグラフ描画ライブラリmatplotlibを使用した。
音声ファイルの入出力には標準ライブラリであるwaveや外部ライブラリのPySoundFileを使用した。

@TODO wavファイル

\
\subsection{Python}\label{python}}

\begin{itemize}
\tightlist
\item
  モジュール

  \begin{itemize}
  \item
    波形プロットモジュール 波形プロット簡易化のモジュールを@に示す。
    @plot\_tools.py
  \item
    音声ファイル入出力モジュール
    音声ファイル入出力のモジュールを@に示す。 @wave\_handler.py
  \end{itemize}
\item
  デコレータ

  \begin{itemize}
  \item
    関数の実行時間計測用デコレータ @decorators.py
  \item
    関数の情報表示用デコレータ @decorators.py
  \end{itemize}
\item
  ツール

  \begin{itemize}
  \item
    音声ファイル畳み込み用プログラム @calc\_covolution\_wav.py
  \item
    ステレオ音声ファイルをLRモノラル音声に分割するプログラム
    @calc\_stereo2monoLR.py
  \item
    2つのwavファイル間の伝達関数を求めるプログラム
    @calc\_pseudo\_ir\_between\_wav\_files.py
  \item
    csvファイルの各列のデータをそれぞれwavファイルに変換するプログラム
    @csv\_to\_wav\_each\_column.py
  \item
    目的の音声ファイルからノイズの音声ファイルに含まれる成分を取り除くプログラム（スペクトラムサブトラクション法）
    @calc\_subtracted\_wav.py
  \item
    指定秒数分の白色雑音をサンプリング周波数48kHzで生成するプログラム
    @generate\_white\_noise\_as\_wav.py
  \item
    csvファイルからmp4またはgif画像を生成するプログラム
    @plot\_animation\_from\_csv.py
  \item
    csvファイルから波形をプロットするプログラム @plot\_from\_csv.py
  \item
    複数のwavファイルから一枚の図に波形をプロットするプログラム
    @plot\_multiwave.py
  \item
    スペクトログラムを表示するプログラム @plot\_spectrogram\_librosa.py
  \end{itemize}
\end{itemize}

Go言語

\begin{itemize}
\item
  ライブラリ 後述のツールで使用するライブラリ
\item
  プログラム
  エラーハンドリングはデバッグと簡易化のために\texttt{panic}を使用しているが本来はコマンドラインツールには使用するべきではない。

  \begin{itemize}
  \tightlist
  \item
    指定した音圧差で音声を合成するプログラム

    \begin{itemize}
    \tightlist
    \item
      @calc\_noise\_mix
    \end{itemize}
  \item
    2つのwavファイルを畳み込むプログラム

    \begin{itemize}
    \tightlist
    \item
      @convolve\_wav
    \end{itemize}
  \item
    2つのwavファイルを畳み込むプログラム（フーリエ変換を用いた高速版）

    \begin{itemize}
    \tightlist
    \item
      @convolve\_wav\_fast
    \end{itemize}
  \item
    2つのwavファイルもしくはcsvファイルを畳み込むプログラム（フーリエ変換を用いた高速版）

    \begin{itemize}
    \tightlist
    \item
      @convolve\_wav\_fast
    \end{itemize}
  \item
    csvファイルのデータからwavファイルを生成するプログラム

    \begin{itemize}
    \tightlist
    \item
      @csv\_to\_wav
    \end{itemize}
  \item
    @の実験で用いるADFの設定を記述したJSONファイルを生成するプログラム

    \begin{itemize}
    \tightlist
    \item
      @drone\_json\_generator
    \end{itemize}
  \item
    csvファイルのデータから指定したサンプルの平均二乗誤差（MSE）を計算し、csvファイルに新たな列として追記するプログラム

    \begin{itemize}
    \tightlist
    \item
      @calc\_mse\_csv
    \end{itemize}
  \item
    PortAudioを使用した多チャンネル収音用プログラム

    \begin{itemize}
    \tightlist
    \item
      @multirecord
    \end{itemize}
  \item
    DSBファイルからwavファイルに変換するプログラム

    \begin{itemize}
    \tightlist
    \item
      @wav\_to\_DSB
    \end{itemize}
  \end{itemize}
\end{itemize}

@TODO ディレクトリ構造

waveを使用した自作音声入出力モジュールを@に示す。

\
\subsection{定常なFIRフィルタの動作確認}\label{ux5b9aux5e38ux306afirux30d5ux30a3ux30ebux30bfux306eux52d5ux4f5cux78baux8a8d}}

@TODO

\
\subsection{既存のADFライブラリについて}\label{ux65e2ux5b58ux306eadfux30e9ux30a4ux30d6ux30e9ux30eaux306bux3064ux3044ux3066}}

pythonで記述された適応信号処理のライブラリとして\href{https://matousc89.github.io/padasip/index.html\#padasip}{Padasip}というものが存在する。Padasipは信号のフィルタリング、予測、復元、分類といった適応信号処理を簡易化するために設計されたライブラリである。PadasipではLMS・NLMS、AP、RLSをはじめとする主要なアルゴリズムが一通り実装されている。

\
\section{ADFライブラリの制作（Go言語）}\label{adfux30e9ux30a4ux30d6ux30e9ux30eaux306eux5236ux4f5cgoux8a00ux8a9e}}

\
\subsection{ライブラリの設計}\label{ux30e9ux30a4ux30d6ux30e9ux30eaux306eux8a2dux8a08}}

pythonで記述された適応信号処理のライブラリとして\href{https://matousc89.github.io/padasip/index.html\#padasip}{Padasip}というものが存在する。Padasipは信号のフィルタリング、予測、復元、分類といった適応信号処理を簡易化するために設計されたライブラリである。PadasipではLMS・NLMS、AP、RLSをはじめとする主要なアルゴリズムが一通り実装されている。

本研究で制作したADFライブラリはPadasipを参考に設計し、Go言語で実装した。

ライブラリのコードを@に示す。

ライブラリの各関数にはユニットテストが書かれており、GitHub
Actionsを利用して自動テストが行われるため、一定の質が担保されている。

また、ライセンスはMITを採用しているため、使用、再配布、商用利用などが許可されている。詳しくは\href{https://raw.githubusercontent.com/tetsuzawa/go-adflib/master/LICENSE}{MIT
LICENCE}を参照されたい。

\
\subsection{インストール方法}\label{ux30a4ux30f3ux30b9ux30c8ux30fcux30ebux65b9ux6cd5}}

製作したライブラリは\href{https://github.com/tetsuzawa/go-adflib}{GitHub}で公開したため、次のコマンドを実行することでインストールすることができる。

\texttt{go\ get\ github.com/tetsuzawa/go-adflib/adf}

\
\subsection{使用方法}\label{ux4f7fux7528ux65b9ux6cd5}}

以下に基本的なライブラリの使用方法を示す。

\begin{itemize}
\tightlist
\item
  インスタンスの作成 \texttt{NewFilt***}
\item
  フィルタ更新方法

  \begin{itemize}
  \tightlist
  \item
    リアルタイム処理する場合 \texttt{Adapt}
  \item
    測定したデータに対して後から処理する場合 \texttt{Run}
  \end{itemize}
\item
  最適なステップサイズを探す場合 \texttt{ExploreLearning}
\item
  各種パラメータを取得する場合 \texttt{GetParams}
\end{itemize}

詳しい使い方は\href{https://godoc.org/github.com/tetsuzawa/go-adflib}{GoDoc}（Goのパッケージリファレンス）を参照されたい。

サンプルプログラムを@に示す。
